/*
 * This source file was generated by the Gradle 'init' task
 */
package org.example;

import org.junit.jupiter.api.Test;
import static org.junit.jupiter.api.Assertions.*;

class AppTest {
    Double parse(String s) {
        Parser p = new Parser(s);
        return p.expr();
    }

    Long fact(Long n) {
        Long res = 1L;
        for(Long i=1L;i<=n;i++) {
            res *= i;
        }
        return res;
    }

    @Test void appHasAGreeting() {
        assertEquals(parse("4+5"), 4+5);
        assertEquals(parse("log(E)"), Math.log(Math.E));
        assertEquals(parse("PI/E"), Math.PI/Math.E);
        assertEquals(parse("3!!"), fact(fact(3L)).doubleValue());
        assertEquals(parse("0.1+0.2+log(log(30))"),  0.1+0.2+Math.log(Math.log(30)));
        String big_test = "~77 + 34.34*5/(4+5-3)**1.2 + (4^1>>3<<4&1|4^45) + sin(30) + sin(PI/2+0) + E+abs(-45) + log(12!) ";
        assertEquals(
            parse(big_test), 
            ~77 + 34.34*5/Math.pow(4+5-3,1.2) + (4^1>>3<<4&1|4^45) + Math.sin(30) + Math.sin(Math.PI/2+0) + Math.E+Math.abs(-45) + Math.log(fact(12L)) 
        );

    }
}
